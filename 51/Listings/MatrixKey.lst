C51 COMPILER V9.54   MATRIXKEY                                                             05/22/2023 16:03:11 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE MATRIXKEY
OBJECT MODULE PLACED IN .\Objects\MatrixKey.obj
COMPILER INVOKED BY: D:\keil51\C51\BIN\C51.EXE MatrixKey.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\
                    -MatrixKey.lst) TABS(2) OBJECT(.\Objects\MatrixKey.obj)

line level    source

   1          #include <REGX52.h>
   2          #include "Delay.h"
   3          /**
   4           *@brief 矩阵键盘扫描，读取按键键码
   5           *@param   空
   6           *@retval   KeyNumber
   7           按键按下不放，程序会停留在此函数，松手则返回键码，没有按键按下返回0.
   8           */
   9          unsigned char MatrixKey()
  10          {
  11   1          unsigned char KeyNumber = 0;
  12   1          P1 = 0xFF;
  13   1          P1_3 = 0;
  14   1          if (P1_7 == 0)
  15   1          {
  16   2              Delay(20);
  17   2              while (P1_7 == 0)
  18   2                  ;
  19   2              Delay(20);
  20   2              KeyNumber = 1;
  21   2          }
  22   1          if (P1_6 == 0)
  23   1          {
  24   2              Delay(20);
  25   2              while (P1_6 == 0)
  26   2                  ;
  27   2              Delay(20);
  28   2              KeyNumber = 5;
  29   2          }
  30   1          if (P1_5 == 0)
  31   1          {
  32   2              Delay(20);
  33   2              while (P1_5 == 0)
  34   2                  ;
  35   2              Delay(20);
  36   2              KeyNumber = 9;
  37   2          }
  38   1          if (P1_4 == 0)
  39   1          {
  40   2              Delay(20);
  41   2              while (P1_5 == 0)
  42   2                  ;
  43   2              Delay(20);
  44   2              KeyNumber = 13;
  45   2          }
  46   1          P1 = 0xFF;
  47   1          P1_2 = 0;
  48   1          if (P1_7 == 0)
  49   1          {
  50   2              Delay(20);
  51   2              while (P1_7 == 0)
  52   2                  ;
  53   2              Delay(20);
  54   2              KeyNumber = 2;
C51 COMPILER V9.54   MATRIXKEY                                                             05/22/2023 16:03:11 PAGE 2   

  55   2          }
  56   1          if (P1_6 == 0)
  57   1          {
  58   2              Delay(20);
  59   2              while (P1_6 == 0)
  60   2                  ;
  61   2              Delay(20);
  62   2              KeyNumber = 6;
  63   2          }
  64   1          if (P1_5 == 0)
  65   1          {
  66   2              Delay(20);
  67   2              while (P1_5 == 0)
  68   2                  ;
  69   2              Delay(20);
  70   2              KeyNumber = 10;
  71   2          }
  72   1          if (P1_4 == 0)
  73   1          {
  74   2              Delay(20);
  75   2              while (P1_5 == 0)
  76   2                  ;
  77   2              Delay(20);
  78   2              KeyNumber = 14;
  79   2          }
  80   1      
  81   1          P1 = 0xFF;
  82   1          P1_1 = 0;
  83   1          if (P1_7 == 0)
  84   1          {
  85   2              Delay(20);
  86   2              while (P1_7 == 0)
  87   2                  ;
  88   2              Delay(20);
  89   2              KeyNumber = 3;
  90   2          }
  91   1          if (P1_6 == 0)
  92   1          {
  93   2              Delay(20);
  94   2              while (P1_6 == 0)
  95   2                  ;
  96   2              Delay(20);
  97   2              KeyNumber = 7;
  98   2          }
  99   1          if (P1_5 == 0)
 100   1          {
 101   2              Delay(20);
 102   2              while (P1_5 == 0)
 103   2                  ;
 104   2              Delay(20);
 105   2              KeyNumber = 11;
 106   2          }
 107   1          if (P1_4 == 0)
 108   1          {
 109   2              Delay(20);
 110   2              while (P1_5 == 0)
 111   2                  ;
 112   2              Delay(20);
 113   2              KeyNumber = 15;
 114   2          }
 115   1          P1 = 0xFF;
 116   1          P1_0 = 0;
C51 COMPILER V9.54   MATRIXKEY                                                             05/22/2023 16:03:11 PAGE 3   

 117   1          if (P1_7 == 0)
 118   1          {
 119   2              Delay(20);
 120   2              while (P1_7 == 0)
 121   2                  ;
 122   2              Delay(20);
 123   2              KeyNumber = 4;
 124   2          }
 125   1          if (P1_6 == 0)
 126   1          {
 127   2              Delay(20);
 128   2              while (P1_6 == 0)
 129   2                  ;
 130   2              Delay(20);
 131   2              KeyNumber = 8;
 132   2          }
 133   1          if (P1_5 == 0)
 134   1          {
 135   2              Delay(20);
 136   2              while (P1_5 == 0)
 137   2                  ;
 138   2              Delay(20);
 139   2              KeyNumber = 12;
 140   2          }
 141   1          if (P1_4 == 0)
 142   1          {
 143   2              Delay(20);
 144   2              while (P1_5 == 0)
 145   2                  ;
 146   2              Delay(20);
 147   2              KeyNumber = 16;
 148   2          }
 149   1          return KeyNumber;
 150   1      }
 151          unsigned char GetKey()
 152          {
 153   1          unsigned char keynum = 0;
 154   1          if (P3_1 == 0)
 155   1          {
 156   2              Delay(20);
 157   2              while (P3_1 == 0)
 158   2                  ;
 159   2              Delay(20);
 160   2              keynum = 1;
 161   2          }
 162   1      
 163   1          if (P3_0 == 0)
 164   1          {
 165   2              Delay(20);
 166   2              while (P3_0 == 0)
 167   2                  ;
 168   2              Delay(20);
 169   2              keynum = 2;
 170   2          }
 171   1          return keynum;
 172   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    444    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
C51 COMPILER V9.54   MATRIXKEY                                                             05/22/2023 16:03:11 PAGE 4   

   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
